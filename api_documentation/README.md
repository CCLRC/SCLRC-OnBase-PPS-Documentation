# API Documentation

## Path:
```
https://app.pps.land/public-api/v1/<endpoint>
```
## Note:
All requests must be POST requests.
Any other request type will be rejected with error code [405](https://httpstatuses.com/405)

## Request Signing
All API calls must be signed by an API key to be validated.
C# signing key example:
```C#
using System.Security.Cryptography;

namespace Test
{
    public class MyHmac
    {
        private string CreateToken(string message, string secret)
        {
            secret = secret ?? "";
            var encoding = new System.Text.ASCIIEncoding();
            byte[] keyByte = encoding.GetBytes(secret);
            byte[] messageBytes = encoding.GetBytes(message);
            using (var hmacsha256 = new HMACSHA256(keyByte))
            {
                byte[] hashmessage = hmacsha256.ComputeHash(messageBytes);
                return Convert.ToBase64String(hashmessage);
            }
        }
    }
}
```

## Request Payload
The request payload is of `content-type: form-data`.

### Required Parameters:

`json`: string representation of json data to send to PPS.

The string representation of this `json` parameter is what goes into the `data` variable above to generate the signature.
The `json` parameter should also include a key `userToken` of the value which is provided to the user and should be sent with every request.

`orgname`: Organization Name stored by the plugin.

 This is used as a client identifier by PPS.

 `signature`: Signature generated by the API key.

 Here is a cURL example:
 ```bash
 curl -X POST \
  https://app.pps.land/public-api/v1/public-user-login \
  -H 'Cache-Control: no-cache' \
  -H 'Content-Type: application/json' \
  -H 'content-type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW' \
  -F 'json={"userEmail": "testuser","userPassword": "testpassword",  "userToken": "testtoken"}' \
  -F orgname=TestOrg \
  -F signature=4feec9a388bef3fd436be
 ```
You can use [Postman](https://www.getpostman.com/)
or [Insomnia](https://insomnia.rest/) to test requests and get responses from PPS.

 ## Endpoints
The key value pairs may change for certain endpoints below.

### sclrc-onbase-to-pps-transfer
`development status: complete`

Posts data to a parcel record on pps

Required json key-value pairs:
```
userToken
ppn
```

Other json key-value pairs are based on the fields that have to be updated
on the parcel record. This list is not exhaustive and can change later.
```
comp_number (Complaint Number)
comp_filed_date (Complaint filed, in yyyy-mm-dd)
complaint_type (Complaint Type, one of: BOR, Common Pleas)
hearing_date (Hearing Date, in yyyy-mm-dd)
bor_result (Hearing Result, one of: Continued, Dismissed, Direct Transfer, Adjudication/judgement)
date_deed_to_shf (Date deed to Sheriff, in yyyy-mm-dd)
date_acquired (Deed Recorded, in yyyy-mm-dd)
```

Returns on success:
```
message: "Onbase to PPS data transferred"
data: {"ppn": <ppn>}
```
